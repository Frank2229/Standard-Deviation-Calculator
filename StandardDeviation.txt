      ******************************************************************
      * Author: FRANK GLASER
      * Date: 01/30/2021
      * Purpose: THIS PROGRAM OUTPUTS THE STANDARD DEVIATION OF USER-
      *          INPUT.
      * Tectonics: cobc
      ******************************************************************
       IDENTIFICATION DIVISION.
       PROGRAM-ID. STANDARD-DEVIATION.
       DATA DIVISION.
       FILE SECTION.
       WORKING-STORAGE SECTION.
           01 INC PIC 9(4) VALUE 1.
           01 DATA-MEAN PIC S9(4)V9(4).
           01 SUM-OF-SQUARES PIC 9(5)V9(4).
           01 SQUARE-VARIANCE PIC 9(5)V9(4).
           01 DATA-DEVIATION PIC S9(4)V9(4).
           01 DATA-MEAN2 PIC ZZZZ.ZZZZ+.
           01 DATA-DEVIATION2 PIC ZZZZ.ZZZZ.
           01 ONE-DEVIATION-LOW PIC ZZZZ.ZZZZ+.
           01 ONE-DEVIATION-HIGH PIC ZZZZ.ZZZZ+.
           01 TWO-DEVIATION-LOW PIC ZZZZ.ZZZZ+.
           01 TWO-DEVIATION-HIGH PIC ZZZZ.ZZZZ+.
           01 DATA-QUANTITY PIC 9(4).
           01 DATA-TABLE.
               05 DATA-SET PIC 9(3) OCCURS 1000 TIMES.
               05 DATA-VARIANCE PIC 9(3)V9999 OCCURS 1000 TIMES.
               05 DATA-SQUARE PIC 9(5)V9999 OCCURS 1000 TIMES.
       PROCEDURE DIVISION.
       MAIN-PROCEDURE.
           DISPLAY "ENTER TOTAL ENTRIES:".
           ACCEPT DATA-QUANTITY.
           PERFORM ACCEPT-PROCEDURE UNTIL INC > DATA-QUANTITY.
           SET INC TO 1.
           PERFORM ADD-PROCEDURE UNTIL INC > DATA-QUANTITY.
           SET INC TO 1.
           DIVIDE DATA-QUANTITY INTO DATA-MEAN.
           PERFORM DIFFERENCE-PROCEDURE UNTIL INC > DATA-QUANTITY.
           SET INC TO 1.
           PERFORM SQUARE-PROCEDURE UNTIL INC > DATA-QUANTITY.
           SET INC TO 1.
           PERFORM SUM-SQUARE-PROCEDURE UNTIL INC > DATA-QUANTITY.
           SET INC TO 1.
           COMPUTE SQUARE-VARIANCE = SUM-OF-SQUARES / 
      -        (DATA-QUANTITY - 1).
           COMPUTE DATA-DEVIATION = SQUARE-VARIANCE ** 0.5.
           COMPUTE ONE-DEVIATION-LOW = DATA-MEAN - DATA-DEVIATION.
           COMPUTE ONE-DEVIATION-HIGH = DATA-MEAN + DATA-DEVIATION.
           COMPUTE TWO-DEVIATION-LOW = DATA-MEAN - DATA-DEVIATION - 
      -        DATA-DEVIATION.
           COMPUTE TWO-DEVIATION-HIGH = DATA-MEAN + DATA-DEVIATION + 
      -        DATA-DEVIATION.
           MOVE DATA-MEAN TO DATA-MEAN2.
           MOVE DATA-DEVIATION TO DATA-DEVIATION2.
           DISPLAY "MEAN: " DATA-MEAN2.
           DISPLAY "STANDARD DEVIATION: " DATA-DEVIATION2.
           DISPLAY "68.2% OF RESULTS WILL RANGE FROM " 
      -        ONE-DEVIATION-LOW " TO " ONE-DEVIATION-HIGH.
           DISPLAY "95.4% OF RESULTS WILL RANGE FROM "
      -        TWO-DEVIATION-LOW " TO " TWO-DEVIATION-HIGH.
           STOP RUN.
       ACCEPT-PROCEDURE.
           DISPLAY "ENTER NUMBER " INC ":"
           ACCEPT DATA-SET(INC).
           ADD 1 TO INC.
       ADD-PROCEDURE.
           ADD DATA-SET(INC) TO DATA-MEAN.
           ADD 1 TO INC.
       DIFFERENCE-PROCEDURE.
           COMPUTE DATA-VARIANCE(INC) = DATA-SET(INC) - DATA-MEAN.
           ADD 1 TO INC.
       SQUARE-PROCEDURE.
           COMPUTE DATA-SQUARE(INC) = DATA-VARIANCE(INC) ** 2.
           ADD 1 TO INC.
       SUM-SQUARE-PROCEDURE.
           ADD DATA-SQUARE(INC) TO SUM-OF-SQUARES.
           ADD 1 TO INC.
       END PROGRAM STANDARD-DEVIATION.
